<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fast Chat</title>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: #f7f8fa;
    margin: 0; padding: 40px 20px;
    display: flex; flex-direction: column; align-items: center;
  }
  h1 { margin: 0 0 12px; color: #2563eb; }
  .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-bottom: 10px; }
  label { font-weight: 600; }
  input[type="password"] {
    padding: 8px 12px; border-radius: 8px; border: 1px solid #ccc; min-width: 280px;
  }
  textarea {
    width: 100%; max-width: 820px; min-height: 160px;
    padding: 12px; font-size: 15px;
    border: 1px solid #ccc; border-radius: 8px; resize: vertical;
  }
  button {
    margin-top: 10px; padding: 10px 16px;
    font-weight: 600; border: none; border-radius: 8px;
    background: #2563eb; color: #fff; cursor: pointer;
  }
  button:hover { background: #1d4ed8; }
  pre {
    width: 100%; max-width: 820px;
    background: #fff; border: 1px solid #ddd;
    border-radius: 8px; padding: 12px;
    white-space: pre-wrap; word-wrap: break-word;
    overflow-y: auto; max-height: 70vh;
    font-family: "JetBrains Mono", monospace;
  }
</style>
</head>
<body>
  <h1>âš¡ Fast Chat</h1>

  <div class="row">
    <label>API Keyï¼š</label>
    <input type="password" id="userApiKey" placeholder="sk-..." />
  </div>

  <textarea id="prompt" placeholder="è¾“å…¥æç¤ºè¯..."></textarea>
  <button id="sendBtn">å‘é€</button>
  <pre id="output">ï¼ˆç­‰å¾…è¾“å…¥ï¼‰</pre>

  <!-- æ‹¼æ¥æç¤ºè¯é¢æ¿ -->
<div class="prompt-builder" style="margin-top: 16px; border: 1px solid #e5e7eb; border-radius: 10px; padding: 16px;">
  <h3 style="margin-bottom: 10px; font-size: 16px;">ğŸ”§ æ‹¼æ¥æç¤ºè¯</h3>

  <div style="display: flex; flex-direction: column; gap: 8px;">
    <label>ç›®æ ‡è¯­è¨€ï¼š</label>
    <input type="text" id="targetLang" placeholder="ä¾‹å¦‚ï¼šja æˆ– zh" style="padding:8px;border:1px solid #ccc;border-radius:8px;">

    <label>Bestï¼ˆæœ€ä½³ç¿»è¯‘å‚è€ƒï¼‰ï¼š</label>
    <textarea id="bestExample" placeholder="ä¾‹å¦‚ï¼šAIéŸ³ä¹ç”Ÿæˆå™¨ => éŸ³æ¥½ç”ŸæˆAI" style="min-height:60px;padding:8px;border:1px solid #ccc;border-radius:8px;resize:vertical;"></textarea>

    <label>æºJSONï¼š</label>
    <textarea id="sourceJson" placeholder='åœ¨æ­¤ç²˜è´´åŸå§‹JSON' style="min-height:120px;padding:8px;border:1px solid #ccc;border-radius:8px;resize:vertical;font-family:monospace;"></textarea>

    <button id="buildPromptBtn" class="btn btn-ok" style="margin-top: 10px;">âš™ï¸ æ‹¼æ¥æç¤ºè¯</button>
  </div>
</div>


<script>
const API = "https://fast-chat-worker.ne0s0u1-pd.workers.dev"; // ä¾‹å¦‚ https://fastchat.ne0s0u1.workers.dev

const promptEl = document.getElementById("prompt");
const keyEl = document.getElementById("userApiKey");
const outputEl = document.getElementById("output");
const sendBtn = document.getElementById("sendBtn");

// ä»æœ¬åœ°å­˜å‚¨æ¢å¤ key
keyEl.value = localStorage.getItem("user_api_key") || "";
keyEl.addEventListener("input", () => {
  localStorage.setItem("user_api_key", keyEl.value);
});

sendBtn.addEventListener("click", async () => {
  const prompt = promptEl.value.trim();
  const key = keyEl.value.trim();
  if (!prompt) return alert("è¯·è¾“å…¥æç¤ºè¯");
  if (!key.startsWith("sk-")) return alert("è¯·è¾“å…¥æœ‰æ•ˆçš„ API Key");

  outputEl.textContent = "â³ æ­£åœ¨è¯·æ±‚...";
  sendBtn.disabled = true;

  try {
    const res = await fetch(API, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text: prompt, userApiKey: key })
    });

    if (!res.ok) throw new Error("HTTP " + res.status);
    const data = await res.json();
    outputEl.textContent = data.reply || JSON.stringify(data, null, 2);
  } catch (err) {
    outputEl.textContent = "âŒ é”™è¯¯ï¼š" + err.message;
  } finally {
    sendBtn.disabled = false;
  }
});

  // æ‹¼æ¥æç¤ºè¯é€»è¾‘
document.getElementById("buildPromptBtn").addEventListener("click", () => {
  const lang = document.getElementById("targetLang").value.trim();
  const best = document.getElementById("bestExample").value.trim();
  const srcJson = document.getElementById("sourceJson").value.trim();

  if (!lang || !srcJson) {
    alert("è¯·è‡³å°‘å¡«å†™ç›®æ ‡è¯­è¨€ä¸æºJSONã€‚");
    return;
  }

  const template = `ä½ æ˜¯ä¸€åä¸“ä¸šçš„å¤šè¯­è¨€æœ¬åœŸåŒ–ä¸ SEO ç¿»è¯‘ä¸“å®¶ã€‚ç°éœ€è¦å°†è¾“å…¥çš„JSONä¸ºç›®æ ‡è¯­è¨€ï¼Œå¹¶è¾“å‡ºä¸ºåœ¨åŸç‰ˆJSONä¸Šæ”¹åŠ¨åå½¢æˆçš„JSON
ç°åœ¨çš„ç›®æ ‡è¯­è¨€ä¸º ${lang}
æœ€ä½³ç¿»è¯‘ä¸ºï¼š${best}
ã€ç¡¬æ€§è§„åˆ™ã€‘
1. å¾·è¯­è¿å­—ç¬¦ï¼ˆ-ï¼‰ç¦æ­¢è§„åˆ™ â€” æœ€é«˜ä¼˜å…ˆçº§ï¼š
2. ä»»ä½•å¾·è¯­ç¿»è¯‘ä¸­ç»å¯¹ç¦æ­¢å‡ºç°è¿å­—ç¬¦ï¼ˆâ€œ-â€ï¼‰ï¼Œæ— è®ºåŸæ–‡æ˜¯å¦åŒ…å«ï¼›å¿…é¡»æ”¹ä¸ºå¸¸è§çš„è‡ªç„¶ä¹¦å†™ã€‚
ä¾‹å¦‚ â€œAUDIO-ZU-MIDIâ€ å¿…é¡»è¾“å‡ºä¸º â€œAudio zu MIDIâ€ï¼ˆæ— è¿å­—ç¬¦ï¼‰ï¼Œè€Œéä»»ä½• â€œAudio-zu-MIDI / Audio-Zu-Midiâ€ç­‰å¸¦è¿å­—ç¬¦å½¢å¼ã€‚
è‹¥å»æ‰è¿å­—ç¬¦ä¼šå½±å“å¯è¯»æ€§æˆ– SEOï¼Œä¹Ÿå¿…é¡»ä¼˜å…ˆå»æ‰è¿å­—ç¬¦å¹¶é‡‡ç”¨æœ€å¸¸è§çš„å†™æ³•ï¼ˆå¯ç”¨ç©ºæ ¼æˆ–åˆé€‚å¤§å°å†™æ›¿ä»£ï¼‰ã€‚
3. è¿”å›çš„å¿…é¡»æ˜¯JSONï¼Œä¸”ä¸èƒ½è¾“å‡ºå…¶ä»–æ— å…³å†…å®¹
4. åªæ”¹åŠ¨JSONä¸­æ–‡æ¡ˆç›¸å…³å†…å®¹ï¼Œidï¼Œcomponentï¼ŒCTALinkLinkä¹‹ç±»çš„ä¸å¾—ç¿»è¯‘
5. â€œ|â€ æ˜¯æ™®é€šæ­£æ–‡å­—ç¬¦ï¼Œç»éåˆ†éš”ç¬¦ï¼›ä¾‹å¦‚ â€œFree Key and BPM Finder | Find Song Key & BPM Onlineâ€ å¿…é¡»è§†ä¸º ä¸€å¥å®Œæ•´æ–‡æœ¬æ•´ä½“ç¿»è¯‘ï¼Œç»ä¸èƒ½æ‹†åˆ†ã€‚
6. æœ¬åœŸåŒ– + SEO ä¼˜å…ˆï¼šé‡‡ç”¨ç›®æ ‡å¸‚åœºæœ€è‡ªç„¶ã€æœç´¢é‡æ›´é«˜çš„è¯´æ³•ï¼›é¿å…é€è¯ç›´è¯‘ï¼›è¡Œä¸šä¸­å¸¸ä¿ç•™çš„è‹±æ–‡å¤–æ¥è¯å¯ä¿ç•™ã€‚
7. å“ç‰Œå/ä¸“æœ‰åè¯æŒ‰ç›®æ ‡å¸‚åœºçº¦å®šå¤„ç†ï¼šå¸¸è§ä¸ç¿»è¯‘çš„ä¿ç•™åŸæ–‡ï¼›ç¿»è¯‘ä¼šè‡´æ­§ä¹‰æ—¶ä¿æŒåŸæ–‡ã€‚
8. éå¸¸é‡è¦ï¼šè¦å°†JSONä¸­çš„CTAlinkä¿®æ”¹æˆå¯¹åº”è¯­è¨€çš„linkï¼Œæ¯”å¦‚æºJSONä¸º/music-generatorï¼Œéœ€è¦ç¿»è¯‘æˆç¹ä½“ä¸­æ–‡ï¼Œé‚£ä¹ˆä¿®æ”¹åçš„å°±æ˜¯/tw/music-generator
9. è‹¥åŸJSONä¸­çš„...labelnameä¸ºä¸­æ–‡ï¼Œä¸å¾—ç¿»è¯‘ï¼Œä¿ç•™ä¸­æ–‡
ã€è¾“å‡ºæ ¼å¼ï¼ˆåŠ¡å¿…ä¸¥æ ¼éµå®ˆï¼‰ã€‘
ä¸å¾—å‡ºç°å¤šä½™å¼•å·ã€é¢å¤–è§£é‡Šæˆ– Markdown åŒ…è£¹ã€‚
å¿…é¡»ä¿æŒåŸæœ‰JSONçš„ç»“æ„ä¸èƒ½æ”¹åŠ¨
ä»¥ä¸‹æ˜¯æºJSON

${srcJson}
`;

  const targetBox = document.getElementById("prompt") || document.getElementById("customPrompt");
  if (targetBox) {
    targetBox.value = template;
    targetBox.scrollIntoView({ behavior: "smooth" });
  }
  showToast("æç¤ºè¯å·²æ‹¼æ¥å®Œæˆ");
});

</script>
</body>
</html>
